# react-translot
## 1.简介
### 1.1作品创意/项目背景
随着网络和技术不断发展，当代人在很多时候需要去解决生活中的一些需要专业性知识才能解决的问题，很多问题需要跨越多个专业，而这对于脑海中充满想象，希望制作出理想中的作品的创新者而言非常具有挑战性，诚然可以对对应的领域进行一定程度的学习后，这样一些富有创意的创造者们能够以最灵动和精确的把控来展现他们的作品，但是这需要的成本就是大量的时间。有时，如果有一条捷径，让创意可以很快地呈现在眼前，这样作者就可以切实地看到这个产品，无论是实物还是虚拟的物品，这对于创意创造在我们看来之分重要，对创意也会具有很好的推动作用。我们很难去深入彻底地掌握所有会使用到的技术或技巧，这就引导我们想到了一个需求互助平台，依托Translot这样一个平台，创意提出者可以在平台上发布他们的想法，之后有相应技能的人就可以在平台上发现这些点子，帮助提出者完成这一创意。
我们的初衷是想构建一个互相帮助完成创意的生态，尤其对于学生而言，他们所接触领域，能人无数，这一方面他们有能力确有时缺少一定的创意来给予他们创作的动力，而对于别人，他们有无穷无尽的想法，却无法转变为现实。基于这个矛盾，我们要构建这样的互助生态。
Translot需求互助平台的主要功能包括一个整体展示、用户管理、需求发布、接受和互动模块。我们期望的理想受众是制作或虚拟商品、服务型帮助类需求者，以及怀有技能的人。
核心的功能主要包括：平台注册用户在平台上发布自己的想法（如3D模型设计，只需要将自己的想法大致描述或绘制草稿），需求发布时可以选择是否给完成者支付一定的报酬，平台上的其他注册用户在浏览到该需求时可以选择接受这个需求，并附上自己的制作或完成计划和想法以及附件（如果能够提前得出一些想法或思路），需求的发布者在得到通知自己的需求被接受时可以浏览接收者的留言和附件，需求发布者可以在多个接受者中选择一个认为比较信赖和技术能力与自己的想法相符的接受者。之后这一对接受关系就进入工作状态，发布者和接受之间通过在平台上互相发送消息来保持联系，并可以通过互相发送的文件等内容得知工作完成的进度。在发布者认为自己的想法已经得到理想的结果后，这一需求就宣告完成。
我们旨在提供一个富有生机、具有成熟的承接逻辑的需求互助平台，大大简化用户为实现自己的想法寻求帮助的过程成本，令用户的期待快速实现，以最低的时间成本是自己的想法触手可得顷刻可见。为实现这样一个为用户快速实现想法的创新互助平台，最好的解决方案就是制作一个成熟跨平台的WEB应用，我们制作一个功能全面，安全稳固，界面舒畅的WEB交互网站和手机端APP应用，来真正解放用户的制作能力，释放用户的创造力，使得用户可以便捷地将自己的想法描述发表，随后这些想法也会得到怀揣着技能的人的响应和帮助。



### 1.2项目实施计划
钱苏尧负责APP、网站和服务端架构设计，项目计划。负责数据库设计、关键数据结构设计、负责后端开发，对架构以及逻辑代码在保障功能的前提下尽可能简化结构和接口设计，减少代码冗余。负责安全性设计，服务器运维。
江宇辉负责前端用户界面设计、前端开发，负责系统测试调优、APP客户端设计开发、
	
项目开发历时四个月，第一个月为系统可行性分析、逻辑设计、架构设计，第二三个月为后端设计开发、前端设计开发、调试测试，第四个月为系统测试、服务器部署。


## 2总体设计
### 2.1系统功能
在现在网络上，即使我们无法拥有某些复杂的制造工具，我们都可以方便地通过网络上的商家，将需要制作的模型后就可以由商家代打，非常便捷、经济。这种制作交易形式完美地解决了从图纸到实物的问题。而在我们的Translot平台则致力于解决从想法到模型到图纸的问题，这两个对象之间的关系则比从图纸到实物具有更大的挑战，从图纸到实物的跨越的难度主要在于设备条件对于普通用户来讲难以得到满足，通过在互联网进行按需收费制造就可以解决这一问题，而我们的从想法到图纸的问题的核心困境在于拥有想法的用户可能缺乏技术，以简单的3D模型制作打印为例，用户需要先将自己的想法在autoCAD等软件中绘制模型，之后才可以导出图纸最终得到实物。在这样的例子中，并不是所有人都学习过3D模型的制图，若要去学习也需要花费一段时间，对于这一类技术坎坷的问题，再加上熟悉掌握对应的技术可能消耗的时间成本，并且由于专业知识背景的不匹配不一致，使得用户需要自学许多与自己的知识背景相距甚远的知识和技术。传统的寻求帮助例如通过网上论坛等平台发帖求助、求助淘宝小型店家、寻求朋友或他人帮助等，这些解决方式有许多劣势，这样进行求助容易暴露用户自己的信息，此外可能耗费的时间和精力非常多，甚至有大量的时间花在处理和帮助者的关系上，还有财产问题有时也会受到威胁，用户极易在寻求帮助的过程中被他人欺骗。
我们的平台主要核心是一个需求、帮助模型：实现形式是一个类论坛的平台，如此设计的原因在于对于需求的发布和接受的人两者之间的关系并不是固定指定的，我们平台要对用户的想法的协助过程去向负责，用户发布的需求展示后必定可能收到多个协助者的帮助，发布的用户可以以接受者上传的预览成果或文字描述为依据，来判断指定某个接受者完成他们的想法。在平台上提交想法后，其他登录用户就能够以需求信息和发布者发布的报酬价格为依据，选择接受。尤其对于学生而言，他们所接触领域，能人无数，这一方面资源没有被充分的利用。基于这个问题，这样的需求互助系统，可以上传自己的需求，而其他用户可以根据自己擅长领域帮助其他人和接受委托。完成者也可以在这个协作的过程中提升自身能力，由此构建一个具有创新生态的需求互助平台。
系统功能主要包括了用户的互助的过程以及用户的互动实现，平台注册用户在平台上发布自己的想法（如3D模型设计，只需要将自己的想法大致描述或绘制草稿），需求发布时可以选择是否给完成者支付一定的报酬，平台上的其他注册用户在浏览到该需求时可以选择接受这个需求，并附上自己的制作或完成计划和想法以及附件（如果能够提前得出一些想法或思路），需求的发布者在得到通知自己的需求被接受时可以浏览接收者的留言和附件，需求发布者可以在多个接受者中选择一个认为比较信赖和技术能力与自己的想法相符的接受者。之后这一对接受关系就进入工作状态，发布者和接受之间通过在平台上互相发送消息来保持联系，并可以通过互相发送的文件等内容得知工作完成的进度。在发布者认为自己的想法已经得到理想的结果后，这一需求就宣告完成。
Translot需求互助平台的主要功能包括需求展示模块、搜索系统、用户管理系统、需求发布模块、评论模块、点赞模块、文件上传模块、接受模块、对话模块和互动模块。
需求展示模块：对用户发布的需求条目进行展示，需求条目内容主要包括需求标题、需求类别标记、需求描述、需求正文、需求附件、需求想法点赞、需求想法评论。可以根据用户的需要以相应的方式展示需求条目，包括通过需求类别标记、需求发布者等进行筛选展示。
搜索系统：对用户发布的需求，根据用户键入的关键字进行搜索，并进行基于时间等属性的排序。
用户管理系统：维护用户的多维信息，包括用户的用户名、昵称、头像、性别、生日等基本信息。除此以外还有用户的点赞记录，用户爱好信息，基于用户完成的需求数量的评分信息。
需求发布模块：主要包括了需求发布的逻辑实现，需求的内容主要包括需求标题、需求类别标记、需求描述、需求正文、需求附件、需求报酬。用户通过文本编辑器以及附件上传描述需求。
评论模块：该模块维护用户对一个用户发布的一条需求想法的态度，是一个评价性功能，主要用域展示，对接受者起到参考作用。
点赞模块：维护需求条目的点赞信息，对接受者起到参考作用。
文件上传模块：维护文件的上传以及文件的下载。上传完成的文件以附件的形式出现在用户的需求、接受或对话中。
接受模块：这一模块主要维护对需求条目的接受动作。接受一直到需求完成实际包括两部分动作，其一是需求被协助者接受，其二是发布者在多个接受自己需求的协助者中择其一继续到下一阶段（工作阶段），通过双方对话交换工作进程信息，最终到达完成状态。
对话模块：这一模块主要维护已经进入工作状态的需求的发布者和接受者之间的对话（交换工作进程信息）状态，其中对话可以包含附件，即由文件上传模块维护的附件信息。
互动模块：这一模块是对接受模块和对话模块的逻辑封装，即从未接受状态一直到接受状态再到工作状态最终到达完成状态的整体逻辑封装。

### 2.2系统软硬件平台
#### 2.2.1系统开发平台（含开源/第三方工具）
后端系统：使用Golang + MariaDB + Redis的架构。最终生产环境在Linux操作系统之上使用Docker部署，容器化运行。
Golang语言使用Gin框架实现Restful API；
数据库采用MariaDB 10.4版本；
Redis使用5.0版本。
所使用到的工具或IDE：
Linux：Centos 7
Gin WEB：github.com/gin-gonic/gin v1.6.2
JWT无状态Token工具：github.com/dgrijalva/jwt-go v3.2.0
Redis连接驱动：github.com/gomodule/Redigo v2.0.0
MySQL（MariaDB）数据库连接驱动：github.com/go-sql-driver/mysql v1.5.0
GORM ORM操作库：github.com/jinzhu/gorm v1.9.12
Goland 2019.x版本；vscode 1.x版本；

前端系统：使用React + Umi + dva + Ant的架构。在React框架、Node Webpack 下开发，最终生成部署文件。
React使用16.8.6版本；Umi使用2.7.7版本；Dva使用2.6.0版本；
Ant-design使用3-x 版本；
所使用到的工具或IDE：
Node使用v12.14.1版本。
Yarn 使用1.12.1版本。
首页背景粒子效果：npmjs.com/package/react-particles-js
富文本编辑器：github.com/HarryChen0506/react-markdown-wditor-lite 
部分界面Ui功能：github.com/mui-org/material-ui
React头像裁组件：github.com/roadmanfong/react-cropper
所使用到的工具或IDE：Webstorm 2019.x版本、vscode 1.x版本。
#### 2.2.2系统运行平台
WEB网站推荐使用Chrome、Firefox、Edge等现代浏览器打开浏览。
APP推荐设备Android 8.0及以上版本，兼容Android5.1及以上版本。
后端分布式部署在Docker容器中，基于CentOS Linux 7。
数据库MySQL/MariaDB、Redis。
后端服务程序：Golang静态连接编译（无动态链接库要求、推荐kernel 3.10以上版本）。
网络通信使用HTTPS加密。
资源交换使用基于Restful API的接口设计。
### 2.3关键技术
本作品开发使用了前后端分离的架构设计，主要优点是应用在开发完成后就可以同时兼容WEB端和手机端，因为手机APP交互基本上在目前的流行度已经超越PC端，前后端分离的开发模式非常必要。
使用Controller和两层Model分层设计开发，Controller根据URL形式句法进行请求转发，数据库数据由数据库模型结构定义，用户层数据信息通过用户参数结构定义，通过定义转换函数，对两层数据的传递进行统一管理，增强了系统内部信息对外界的安全性，也增加了用户层数据传递的灵活性，通过在两层数据转换函数定义交叉调用，即可实现用户数据模型的嵌套整合，强化了接口数据结构的可扩展性。
本作品的用户认证方式使用JWT方式，它不同于会话方式需要在服务端维护客户端会话的状态，通过向用户分发已经使用服务端定义好的密钥签名的会话id和用户id即可实现对用户登陆状态的感知。
用户登录状态在Redis中额外存储，在Reids中存储当前的用户id和使用时间戳生成的会话id，以弥补JWT无状态令牌的签名信息一旦签发就无法进行吊销的缺点，确保了用户的安全性。
完全使用符合Restful API一般形式的接口设计进行前后端数据交换实现，增强系统可拓展性和稳固性。
数据库设计使用ORM模型，使用结构对数据库内部表结构进行映射，数据库操作使用ORM对象关系模型产生SQL语句，实现数据库增删改查以增强系统的稳固性和数据完整性和数据模型统一性。
使用Redis服务器作为缓存，对点赞信息以及查看计数在Redis使用原子操作进行存储，确保了操作的原子性、数据完整性，分批定期写回数据库，降低系统执行开销。
### 2.4作品特色
本作品着眼于用户的创意矛盾问题，致力于对创新创造的要素完善，能力放大。如同推动从“图纸”到“实物”的行动一样，我们的作品让用户的构想转换为“图纸”变得唾手可及。本平台的核心关注点在于对用户需求发布者和需求接受的角色把握，将原来繁琐或需要消耗大量时间的需求互助活动通过技能共享的方式方便用户实现他们的创意。本作品利用移动客户端在当今网络社交中的重要地位开发了整套APP和WEB网站平台，方便用户便捷地完成需求互助的沟通和互利。
本作品的开发实现中使用了很多优化用户体验、提升系统性能、提升可移植性的设计。用户界面使用现代化响应式设计，界面设计直观易懂，方便用户上手使用。
团队在接受模型的构思、设计和实现上花费很大心血，从用户、技能者心理的角度进行可行性分析、从数据关联的角度对模型进行精细化设计与分析。在数据库表的设计上，为了对性能便利性和数据完整性之间的权衡，最终设计出符合BCNF范式的数据库模型，
本作品在开发中使用Golang作为后端服务器实现，
利用Golang用户态协程并发的特性，保障了后端服务器在高并发场景下的稳定性和高响应。
利用在JSON传递数据解析时进行数据有效性过滤、JWT认证中间件的方式保障了安全性。
利用Redis的高速特性满足对频繁查改的数据的支持度，例如点赞数据和需求条目的查看次数的计数。
利用Redis存储登录用户的用户信息，减轻数据库负担，加快响应速度。
利用Redis集合和自增命令的原子性实现系统的原子性。
利用ORM模型的结构体传值和SQL语句预准备避免了SQL注入的发生。
利用HTTPS协议通信强化服务器身份的可信性、保障数据传输的保密性。
符合Restful API一般要求的HTTP动词和URL格式的设计，强化了系统的可扩展性。

## 3详细设计
### 3.1系统结构设计
#### 3.1.1技术架构
本作品开发使用了前后端分离的架构设计，主要优点是应用在开发完成后就可以同时兼容WEB端和手机端，因为手机APP交互基本上在目前的流行度已经超越PC端，可以轻松实现B/S平台和移动平台的共存。APP开发使用在网页开发的基础上加入响应式设计，通过WEB View的方式构建在手机客户端运行的APP应用，具有很强的灵活性和可扩展性。
作品采用了React提供底层开发语言的支持，React是用于构建用户界面的JavaScript库，数据改变时React高效地更新渲染界面，模块化创建各自状态的组件，在传递数据时将应用状态和DOM拆分开；
前端开发使用umi框架，类next.js且功能完备的路由约定，同时支持配置路由方式，在umirc.js中配置路由，支持mock数据，在前期脱离后端模拟数据提供api，模拟接口延迟动态数据，在后期关闭mock配置proxy代理跨域请求，结合antd基于路由实现按需加载组件和模块，加快页面渲染加载速度，性能得到提高，配合dva降为0API。
前端使用dva是基于React+Redux+Saga的数据流方案，简化了React的setState跨组件传输数据耦合，数据通过mapStateToProps实现同步，其中models类似于MVC控制器角色，设计model state进行抽象数据，完成组件component进行视图的设计后，将组件和model建立关联，通过dispatch一个action，在reducer中更新数据完成数据同步处理，从服务器获取数据时，通过Effects数据异步处理，调用Reducer更新全局state，Service模块负责网络请求数据的服务，其中请求采用了umi-request，它是基于 fetch 封装的开源 http 请求库，兼具 fetch 与 axios 的特点。
服务端使用Golang实现开发，使用Gin Web开发框架对不同的URL请求实现高效转发，使用Web中间件来对请求进行认证过滤，增强了系统的稳定性，使用Redis缓存登录用户的用户信息、用户对需求的点赞信息和查看次数计数，减轻数据库负担。
使用Controller和两层Model的分层实现思想，在Controller层实现对连接请求的高效转发，在用户Model层实现对用户提交数据的维护和回应，通过数据库Model层实现对数据库表结构的映射，通过用户Model层的嵌套和两层的转换函数实现返回数据的嵌套整合，强化数据的映射关系，增强数据结构的灵活性。
数据库采用对象关系映射（ORM）进行管路，增强数据存储的结构性，降低代码的冗余，增强代码的可读性。符合Restful API一般要求的HTTP动词和URL格式的设计，强化了系统的可扩展性。利用在JSON传递数据解析时进行数据有效性过滤，使用JWT认证中间件的方式保障了安全性。
